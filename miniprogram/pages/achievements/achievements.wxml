<!--achievements.wxml-->
<view class="page-container">
  <!-- æˆå°±æ¦‚è§ˆ -->
  <view class="achievement-header">
    <view class="header-content">
      <view class="stats-overview">
        <view class="stat-item">
          <text class="stat-number">{{unlockedAchievements}}</text>
          <text class="stat-label">å·²è§£é”</text>
        </view>
        <view class="stat-divider"></view>
        <view class="stat-item">
          <text class="stat-number">{{totalAchievements}}</text>
          <text class="stat-label">æ€»æˆå°±</text>
        </view>
        <view class="stat-divider"></view>
        <view class="stat-item">
          <text class="stat-number">{{completionRate}}%</text>
          <text class="stat-label">å®Œæˆåº¦</text>
        </view>
      </view>
      
      <view class="progress-bar">
        <view class="progress-fill" style="width: {{completionRate}}%"></view>
      </view>
    </view>
  </view>

  <!-- åˆ†ç±»æ ‡ç­¾ -->
  <view class="category-section">
    <scroll-view class="category-tabs" scroll-x>
      <view 
        class="category-tab {{selectedCategory === item.id ? 'active' : ''}}"
        wx:for="{{categories}}" 
        wx:key="id"
        bindtap="onCategoryTap"
        data-id="{{item.id}}"
      >
        <text class="tab-name">{{item.name}}</text>
        <text class="tab-count">({{item.unlockedCount}}/{{item.count}})</text>
      </view>
    </scroll-view>
  </view>

  <!-- æˆå°±åˆ—è¡¨ -->
  <view class="achievements-section">
    <view class="achievement-grid">
      <view 
        class="achievement-card {{item.unlocked ? 'unlocked' : 'locked'}} rarity-{{item.rarity}}"
        wx:for="{{achievements}}" 
        wx:key="id"
        wx:if="{{selectedCategory === 'all' || item.category === selectedCategory}}"
        bindtap="onAchievementTap"
        bindlongpress="onShareAchievement"
        data-id="{{item.id}}"
      >
        <!-- ç¨€æœ‰åº¦è£…é¥° -->
        <view class="rarity-border" wx:if="{{item.rarity !== 'common'}}"></view>
        
        <!-- æˆå°±å›¾æ ‡ -->
        <view class="achievement-icon {{item.unlocked ? '' : 'locked-icon'}}">
          <text class="icon-emoji">{{item.unlocked ? item.icon : 'ğŸ”’'}}</text>
        </view>
        
        <!-- æˆå°±ä¿¡æ¯ -->
        <view class="achievement-info">
          <text class="achievement-name">{{item.name}}</text>
          <text class="achievement-desc">{{item.description}}</text>
          
          <!-- è¿›åº¦æ¡ -->
          <view class="progress-section" wx:if="{{!item.unlocked}}">
            <view class="progress-text">
              <text class="progress-label">{{item.requirement}}</text>
              <text class="progress-numbers">{{item.progress}}/{{item.target}}</text>
            </view>
            <view class="mini-progress-bar">
              <view class="mini-progress-fill" style="width: {{(item.progress/item.target)*100}}%"></view>
            </view>
          </view>
          
          <!-- è§£é”æ—¶é—´ -->
          <view class="unlock-date" wx:if="{{item.unlocked}}">
            <text class="date-text">{{item.unlockedDate}} è§£é”</text>
          </view>
        </view>

        <!-- ç¨€æœ‰åº¦æ ‡ç­¾ -->
        <view class="rarity-tag rarity-{{item.rarity}}" wx:if="{{item.rarity !== 'common'}}">
          <text class="rarity-text">
            {{item.rarity === 'rare' ? 'ç¨€æœ‰' : item.rarity === 'epic' ? 'å²è¯—' : 'ä¼ è¯´'}}
          </text>
        </view>

        <!-- è§£é”æ•ˆæœ -->
        <view class="unlock-effect" wx:if="{{item.unlocked}}">
          <text class="unlock-text">âœ¨</text>
        </view>
      </view>
    </view>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty-state" wx:if="{{achievements.length === 0}}">
    <image src="/images/empty-achievements.png" class="empty-icon" mode="aspectFit" />
    <text class="empty-text">æš‚æ— æˆå°±æ•°æ®</text>
    <text class="empty-subtitle">ä¸‹æ‹‰åˆ·æ–°é‡æ–°åŠ è½½</text>
  </view>

  <!-- åº•éƒ¨é—´è· -->
  <view class="bottom-spacing"></view>
</view>
