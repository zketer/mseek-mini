<!--热门博物馆列表页面-->
<view class="hot-museums-container">

  <!-- 加载状态 -->
  <view wx:if="{{loading}}" class="loading-container">
    <view class="loading-spinner"></view>
    <text class="loading-text">正在加载热门博物馆...</text>
  </view>

  <!-- 博物馆列表 -->
  <view wx:else class="museums-list">
    <!-- 搜索框 -->
    <view class="search-container">
      <view class="search-box">
        <icon type="search" size="16" color="#999" class="search-icon"></icon>
        <input 
          class="search-input" 
          placeholder="搜索热门博物馆..." 
          value="{{searchKeyword}}"
          bindinput="onSearchInput"
          bindconfirm="onSearchConfirm"
        />
        <view wx:if="{{searchKeyword}}" class="search-clear" bindtap="onSearchClear">
          <icon type="clear" size="14" color="#999"></icon>
        </view>
      </view>
    </view>

    <!-- 统计信息 -->
    <view class="stats-header">
      <text class="stats-text">{{searchKeyword ? '搜索到' : '共找到'}} {{total}} 家{{searchKeyword ? '' : '热门'}}博物馆</text>
      <text class="stats-desc">{{searchKeyword ? '搜索结果' : '按打卡热度排序'}}</text>
    </view>

    <!-- 博物馆卡片 - 两列布局 -->
    <view class="museums-grid">
      <view 
        wx:for="{{museums}}" 
        wx:key="id" 
        class="museum-card"
        data-id="{{item.id}}"
        bindtap="onMuseumTap"
      >

        <!-- 博物馆图片 -->
        <view class="museum-image">
          <image src="{{item.image}}" mode="aspectFill" class="image" />
        </view>

        <!-- 博物馆信息 -->
        <view class="museum-info">
          <text class="museum-name">{{item.name}}</text>
          
          <view class="museum-location">
            <text class="location-icon">📍</text>
            <text class="location-text">{{item.location}}</text>
          </view>

          <!-- 博物馆标签 -->
          <view class="museum-tags">
            <!-- 评分标签 -->
            <view class="tag rating-tag">
              <text class="rating-score">{{item.rating}}</text>
              <text class="rating-star">★</text>
            </view>
            
            <!-- 门票价格标签（仅收费博物馆显示） -->
            <view wx:if="{{item.ticketPrice}}" class="tag price-tag">{{item.ticketPrice}}</view>
            
            <!-- 后端返回的标签 -->
            <view wx:for="{{item.tags}}" wx:key="id" wx:for-item="tag" class="tag backend-tag" style="background-color: {{tag.color || '#f0f8ff'}};">
              {{tag.name}}
            </view>
          </view>
        </view>
      </view>
    </view>

    <!-- 加载更多状态 -->
    <view wx:if="{{loadingMore}}" class="loading-more">
      <view class="loading-spinner small"></view>
      <text class="loading-text">加载更多...</text>
    </view>

    <!-- 没有更多数据 -->
    <view wx:elif="{{!hasMore && museums.length > 0}}" class="no-more">
      <text class="no-more-text">已显示全部热门博物馆</text>
    </view>

    <!-- 空状态 -->
    <view wx:if="{{museums.length === 0 && !loading}}" class="empty-state">
      <view class="empty-icon">🏛️</view>
      <text class="empty-title">暂无热门博物馆</text>
      <text class="empty-desc">还没有用户打卡记录</text>
      <button class="empty-button" bindtap="onSearchClear">返回热门列表</button>
    </view>
  </view>
</view>
