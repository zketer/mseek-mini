<!--exhibition/detail.wxml-->
<view class="page-container">
  <view wx:if="{{loading}}" class="loading-container">
    <view class="loading-content">
      <view class="loading-spinner"></view>
      <text class="loading-text">åŠ è½½ä¸­...</text>
    </view>
  </view>

  <view wx:elif="{{error}}" class="error-container">
    <view class="error-content">
      <image src="/images/Icon1.png" class="error-icon" mode="aspectFit" />
      <text class="error-text">{{error}}</text>
      <button class="retry-btn" bindtap="loadExhibitionDetail">é‡æ–°åŠ è½½</button>
    </view>
  </view>

  <view wx:elif="{{exhibitionDetail}}" class="main-content">
  <!-- å›¾ç‰‡è½®æ’­ -->
  <view class="image-section">
    <swiper class="image-swiper" autoplay="{{true}}" interval="4000" duration="500" circular="{{true}}" indicator-dots="{{true}}" indicator-color="rgba(255,255,255,0.5)" indicator-active-color="#fff">
      <swiper-item wx:for="{{exhibitionDetail.images}}" wx:key="*this">
        <image src="{{item}}" mode="aspectFill" class="detail-image" bindtap="onImagePreview" data-url="{{item}}" />
      </swiper-item>
    </swiper>
  </view>

  <!-- å±•è§ˆä¿¡æ¯ -->
  <view class="info-section">
    <view class="exhibition-header">
      <view class="title-with-actions">
        <view class="exhibition-title">{{exhibitionDetail.title}}</view>
        <view class="header-actions">
          <view class="header-btn" bindtap="onFavorite">
            <image wx:if="{{exhibitionDetail.isFavorited}}" src="/images/favorite.svg" class="svg-icon favorite-icon" mode="aspectFit" />
            <image wx:else src="/images/favorite.svg" class="svg-icon favorite-icon-outline" mode="aspectFit" />
          </view>
        </view>
      </view>
      <view class="exhibition-museum">
        <text class="museum-name" bindtap="onNavigateToMuseum">{{exhibitionDetail.museumName}}</text>
        <text class="museum-arrow">â€º</text>
      </view>
      <view class="exhibition-rating" wx:if="{{exhibitionDetail.rating}}">
        <text class="rating-score">{{exhibitionDetail.rating}}</text>
        <text class="rating-total">/5.0 ({{exhibitionDetail.reviewCount}}æ¡è¯„ä»·)</text>
      </view>
    </view>

    <view class="exhibition-meta">
      <view class="meta-item">
        <icon type="clock" size="14" color="#999"></icon>
        <text class="meta-text">{{exhibitionDetail.startDate}} - {{exhibitionDetail.endDate}}</text>
      </view>
      <view class="meta-item" wx:if="{{exhibitionDetail.location}}">
        <icon type="locationfill" size="14" color="#999"></icon>
        <text class="meta-text">{{exhibitionDetail.location}}</text>
      </view>
      <view class="meta-item" wx:if="{{exhibitionDetail.freeAdmission}}">
        <icon type="money" size="14" color="#4CAF50"></icon>
        <text class="meta-text free-admission">å…è´¹å‚è§‚</text>
      </view>
      <view class="meta-item" wx:elif="{{exhibitionDetail.ticketPrice}}">
        <icon type="money" size="14" color="#999"></icon>
        <text class="meta-text">Â¥{{exhibitionDetail.ticketPrice}}/äºº</text>
      </view>
      <view class="meta-item" wx:if="{{exhibitionDetail.isPermanent}}">
        <icon type="star" size="14" color="#FFD700"></icon>
        <text class="meta-text">å¸¸è®¾å±•è§ˆ</text>
      </view>
    </view>

    <!-- å±•è§ˆæ ‡ç­¾ -->
    <view class="exhibition-tags" wx:if="{{exhibitionDetail.tags && exhibitionDetail.tags.length > 0}}">
      <!-- è¯„åˆ†æ ‡ç­¾ -->
      <view class="tag rating-tag" wx:if="{{exhibitionDetail.rating}}">
        <text class="rating-score-tag">{{exhibitionDetail.rating}}</text>
        <text class="rating-star">â˜…</text>
      </view>
      
      <!-- é—¨ç¥¨ä»·æ ¼æ ‡ç­¾ -->
      <view class="tag price-tag" wx:if="{{exhibitionDetail.ticketPrice}}">
        <text class="price-icon">ğŸ’°</text>
        <text class="price-text">Â¥{{exhibitionDetail.ticketPrice}}</text>
      </view>
      
      <!-- å±•è§ˆç±»å‹æ ‡ç­¾ -->
      <view class="tag type-tag {{exhibitionDetail.isPermanent ? 'permanent' : 'temporary'}}">
        {{exhibitionDetail.isPermanent ? 'å¸¸è®¾' : 'ä¸´å±•'}}
      </view>
      
      <!-- ç‰¹è‰²æ ‡ç­¾ -->
      <view wx:for="{{exhibitionDetail.tags}}" wx:key="*this" class="tag feature-tag">
        {{item}}
      </view>
    </view>

    <!-- å±•è§ˆç»Ÿè®¡ä¿¡æ¯ -->
    <view class="stats-section" wx:if="{{exhibitionDetail.visitCount}}">
      <view class="stats-grid">
        <view class="stat-item">
          <text class="stat-number">{{formatNumber(exhibitionDetail.visitCount)}}</text>
          <text class="stat-label">å‚è§‚äººæ•°</text>
        </view>
        <view class="stat-item">
          <text class="stat-number">{{exhibitionDetail.reviewCount || 0}}</text>
          <text class="stat-label">è¯„ä»·æ•°é‡</text>
        </view>
      </view>
    </view>
  </view>

  <!-- å±•è§ˆä»‹ç» -->
  <view class="description-section">
    <view class="section-title">å±•è§ˆä»‹ç»</view>
    <view class="description-content">
      <text class="description-text {{showFullDesc ? 'full-text' : 'ellipsis-text'}}">{{exhibitionDetail.description}}</text>
      <text class="toggle-btn" bindtap="onToggleDesc">{{showFullDesc ? 'æ”¶èµ·' : 'å±•å¼€'}}</text>
    </view>
  </view>

  <!-- å‚è§‚é¡»çŸ¥ -->
  <view class="notice-section">
    <view class="section-title">å‚è§‚é¡»çŸ¥</view>
    <view class="notice-list">
      <view class="notice-item">
        <text class="notice-icon">ğŸ«</text>
        <text class="notice-text">è¯·æŒ‰å±•è§ˆæ—¶é—´å®‰æ’å‚è§‚ï¼Œéƒ¨åˆ†å±•å“å¯èƒ½è°ƒæ•´</text>
      </view>
      <view class="notice-item">
        <text class="notice-icon">ğŸ“·</text>
        <text class="notice-text">éƒ¨åˆ†å±•å“ç¦æ­¢æ‹ç…§ï¼Œè¯·éµå®ˆç›¸å…³è§„å®š</text>
      </view>
      <view class="notice-item">
        <text class="notice-icon">ğŸ”‡</text>
        <text class="notice-text">å‚è§‚æ—¶è¯·ä¿æŒå®‰é™ï¼Œå‹¿å¤§å£°å–§å“—</text>
      </view>
      <view class="notice-item">
        <text class="notice-icon">ğŸ‘¶</text>
        <text class="notice-text">å„¿ç«¥éœ€åœ¨æˆäººé™ªåŒä¸‹å‚è§‚</text>
      </view>
    </view>
  </view>

  <!-- è”ç³»æ–¹å¼ -->
  <view class="contact-section" wx:if="{{exhibitionDetail.contactPhone || exhibitionDetail.website}}">
    <view class="section-title">è”ç³»æ–¹å¼</view>
    <view class="contact-list">
      <view class="contact-item" wx:if="{{exhibitionDetail.contactPhone}}" bindtap="onPhone">
        <icon type="phone" size="16" color="#ff8fa3"></icon>
        <text class="contact-text phone-number">{{exhibitionDetail.contactPhone}}</text>
      </view>
      <view class="contact-item" wx:if="{{exhibitionDetail.website}}" bindtap="onWebsite">
        <icon type="link" size="16" color="#ff8fa3"></icon>
        <text class="contact-text website-link">å®˜æ–¹ç½‘ç«™</text>
      </view>
    </view>
  </view>

    <!-- åº•éƒ¨é—´è· -->
    <view class="bottom-spacing"></view>
  </view>
</view>